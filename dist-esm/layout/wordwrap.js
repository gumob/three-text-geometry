import{WordWrapMode}from"../types";class WordWrap{wrap(r,e={}){return this.lines(r,e).map(e=>r.substring(e.start,e.end)).join("\n")}lines(e,r={}){const t={start:void 0,end:void 0,width:void 0,mode:void 0,measure:void 0};return e=e||"",void 0!==r.start?t.start=Math.max(0,r.start):t.start=0,void 0!==r.end?t.end=r.end:t.end=e.length,void 0!==r.width?t.width=r.width:t.width=Number.MAX_VALUE,void 0!==r.mode&&(t.mode=r.mode),t.measure=r.measure||this.monospace,0===t.width&&t.mode!==WordWrapMode.NoWrap?[]:r.mode===WordWrapMode.Pre?this.pre(t.measure,e,t.start,t.end,t.width):this.greedy(t.measure,e,t.start,t.end,t.width,t.mode)}idxOf(e,r,t,d){t=e.indexOf(r,t);return-1===t||d<t?d:t}isWhitespace(e){return WordWrap.whitespaceRegexp.test(e)}pre(r,t,d,a,i){const o=[];let n=d;for(let e=d;e<a&&e<t.length;e++){var s=t.charAt(e),s=WordWrap.newlineRegexp.test(s);!s&&e!==a-1||(s=s?e:e+1,s=r(t,n,s,i),o.push(s),n=e+1)}return o}greedy(t,d,a,i,e,r){const o=[];let n=e;for(r===WordWrapMode.NoWrap&&(n=Number.MAX_VALUE);a<i&&a<d.length;){for(var s=this.idxOf(d,WordWrap.newlineChar,a,i);a<s&&this.isWhitespace(d.charAt(a));)a++;var h=t(d,a,s,n);let e=a+(h.end-h.start),r=e+WordWrap.newlineChar.length;if(e<s){for(;e>a&&!this.isWhitespace(d.charAt(e));)e--;if(e===a)r>a+WordWrap.newlineChar.length&&r--,e=r;else for(r=e;e>a&&this.isWhitespace(d.charAt(e-WordWrap.newlineChar.length));)e--}e>=a&&o.push(t(d,a,e,n)),a=r}return o}monospace(e,r,t,d){return{start:r,end:r+Math.min(d,t-r),width:0}}}WordWrap.newlineRegexp=/\n/,WordWrap.whitespaceRegexp=/\s/,WordWrap.newlineChar="\n";export{WordWrap};