import*as THREE from"three";function createMultipageShader(e){var t=void 0!==(e=e||{}).opacity?e.opacity:1,o=e.precision||"highp",a=void 0!==e.alphaTest?e.alphaTest:1e-4;let r=e.textures||[];r=Array.isArray(r)?r:[r];const i={};r.forEach((e,t)=>{i["texture"+t]={type:"t",value:e}});const n=r.map(function(e,t){return`uniform sampler2D texture${t};`}).join("\n"),l=r.map(function(e,t){return[(0===t?"if":"else if")+` (vPage == ${t}.0) {`,`sampleColor = texture2D(texture${t}, vUv);`,"}"].join("\n")}).join("\n");var v=e.color||new THREE.Color;delete e.textures,delete e.color,delete e.precision,delete e.opacity;let c={attributes:{page:{type:"f",value:0}}};return 72<=(0|(parseInt(THREE.REVISION,10)||0))&&(c=void 0),Object.assign({uniforms:Object.assign({},i,{opacity:{type:"f",value:t},color:{type:"c",value:v}}),vertexShader:["attribute vec4 position;","attribute vec2 uv;","attribute float page;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","varying float vPage;","void main() {","vUv = uv;","vPage = page;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:[`precision ${o} float;`,"uniform float opacity;","uniform vec3 color;",n,"varying float vPage;","varying vec2 vUv;","void main() {","vec4 sampleColor = vec4(0.0);",l,"gl_FragColor = sampleColor * vec4(color, opacity);",0===a?"":`  if (gl_FragColor.a < ${a}) discard;`,"}"].join("\n")},c,e)}export{createMultipageShader};